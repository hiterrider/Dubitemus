#合成孔径雷达的原始回波获取、处理以及成像（一）

合成孔径雷达能够在方位向对目标进行高分辨率成像。

SAR信号处理可以分为脉冲内的信号处理，即距离向处理；以及脉冲间的处理，即方位向处理。得到二维的原始电场数据后，还需要对其进行正交解调和成像操作才能得到仿真SAR图像。

笔记主要分为两个部分：首先是SAR回波的特性，其次是对SAR回波的数据处理以及成像相关。

##(1)SAR的信号获取过程
![](../Image/2.1.png)

可以用距离等式，即雷达与目标之间的斜距随方位时间（慢时间）的变化关系表述雷达与目标之间的相对运动。重新绘制简化图如下：
![](../Image/2.2.png)

在任意的慢时间$\eta$时刻，雷达到目标的距离$R(\eta)$根据勾股定理可以有如下等式:
$$
R(\eta)=\sqrt{R_{0}^{2}+V_{r}^{2}\eta ^2}\approx R_0+\frac{V_{r}^{2}\eta ^2}{2R_0}
$$

###1.1 距离向信号及其性质

距离向通过发射电磁波并测量目标回波的时间延迟获取。测量获取的回波时间延迟与雷达到目标的距离成正比。

一般而言，SAR发射的信号是LFM信号，也就是线性调频信号，其时域表达式为：
$$
s(t)=rect(\frac{t}{T})cos(2\pi f_0 t+\pi Kt^2)
$$

可以看出其相位项为$ 2\pi f_0 t+\pi Kt^2$,根据信号的瞬时频率正比于相位的导数，可以得到其瞬时频率为$f_0+Kt$,其中，$K$是调频率。可以看出在周期$T$内，LFM信号的带宽即为其扫过的频率范围$B=\left| K \right|T$。可以得到LFM信号的时域特性如下：
![](../Image/2.3.png)

可以通过驻定相位原理(POSP)近似推导信号频域表达式：
$$
G(f)=rect(\frac{f}{\left| K \right|T})exp(-j\pi\frac{f^2}{K})
$$
可以得到LFM信号的频域特性如下：
![](../Image/2.4.png)


###1.2 SAR二维回波信号及其性质
![](../Image/2.5.png)

假设SAR发射的一长度为$T_r$的LFM脉冲，其表达式为：
$$
s_{pul}(\tau)=\omega_{r}(\tau)cos(2\pi f_0 \tau + \pi K_r \tau^2)
$$

假设地面有一点目标，距离雷达$R_a$距离，其后向散射系数为$\sigma_0$，其幅度为$A_0$，表示信号被散射时的衰减，其相位部分是$\psi$,反映散射引起的相位移动。

发射的信号被地面的点目标散射，任意时刻的散射波强度是发射信号与地面散射系数的卷积:
$$
s_r(\tau) = g_r(\tau) * s_{pul}(\tau)
$$

点目标在时域上表现为冲激函数，有冲激响应函数：
$$
g_r(\tau) = A_0 \delta(\tau - 2R_a/c)
$$
则可以得到目标的接收信号为;
$$
s_r(\tau) = A_0 s_{pul}(\tau - 2R_a/c)
\\ =A_0 \omega_r(\tau - 2R_a/c)cos[2\pi f_0 (\tau - 2R_a/c) + \pi K_r (\tau - 2R_a/c)^2+\psi]
$$

可以看出，雷达的回波信号相位部分有三个组成：
1. $2\pi f_0 (\tau - 2R_a/c)$：雷达载频组成的高频分量，可以通过正交解调去除，提取出调制在基带信号上的信息
2. $\pi K_r (\tau - 2R_a/c)^2$: 线性调频引起的低频分量
3. $\psi$ 散射引起的相位移动

将地面所有的散射点的散射场进行叠加，就可以得到当前脉冲的总散射场。雷达在飞行过程中不断重复这一过程，所有的脉冲的接收电场信号构成一个关于时间的一维函数。其数据接收过程可以有下图：
![](../Image/2.6.png)

综上所述，我们可以得到关于目标的一组二维数据。其横向表示距离维，表示信号的传播时间，等价于在当前方位下目标到雷达的距离。每一个脉冲的散射电场被记录为一行。纵向表示信号的方位维，不同方位时间，雷达在航迹上的位置不同。

将$R_a$改写维关于方位维的函数$R(\eta)$,同时窗函数会受到天线方向图的作用，可以写成$\omega_a(\eta-\eta_c)$,代入回波，则点目标的接收电场可以写作：
$$
s_r(\tau) = A_0 s_{pul}(\tau - 2R_\eta/c)
\\ =A_0 \omega_r(\tau - 2R_\eta/c)\omega_a(\eta-\eta_c)\times cos[2\pi f_0 (\tau - 2R_\eta/c) + \pi K_r (\tau - 2R_\eta/c)^2+\psi]
$$

###1.3 SAR多普勒历程分析

由于雷达与目标之间的相对运动会导致两者之间的距离不断变化，因此产生了多普勒效应。多普勒效应能对方位向信号进行天然的调制，能够提高方位分辨率。但是当不同方位之间的时间延迟变化程度超过了一个距离分辨单元，则会造成距离徙动($RCM$)。

下面对点目标回波信号的多普勒效应进行分析：

由之前的回波信号表达式可以得到相位：
$$
\phi(\tau,\eta)=2\pi f_0 (\tau - 2R_\eta/c) + \pi K_r (\tau - 2R_\eta/R_\eta/c)^2+\psi
\\=2\pi f_0 \tau -\frac{4 \pi f_0 R(\eta)}{c}+\pi K_r (\tau - \frac{2R(\eta)}{c})^2 + \psi
$$

第一项是信号载频带来的相位，可以通过正交解调去除，第四项是散射造成的相移。其中第二项和第三项分别代表的是方位向和距离向的相位调制。

第二项关于慢时间$\eta$求导的结果是方位向的瞬时频率：
$$
f_a = \frac{1}{2 \pi} \frac{d}{d \eta}(- \frac{4 \pi f_0 R(\eta)}{c})=- \frac{2}{\lambda}\frac{dR(\eta)}{d \eta} = f_d
$$

可以看出，多普勒项历程信息蕴藏在时间延迟引起的方位向相位调制中。

第三项同时受到距离向和方位向的时间调制，存在两维的耦合。因此SAR的运动不仅带来了方位向的相位调制，也带来了距离的徙动。这是后续的信号处理所必须解决的问题。


##(2) SAR信号处理

###2.1 正交解调和SAR原始回波

SAR的原始回波指的是用于成像的一组二维的复数据，是雷达天线接收电场经过正交解调得到的。

一般而言，正交解调可以去除雷达的载频，即前述相位项的第一项，得到了一个复基带信号。然后对去掉载频的低频信号进行采样，将距离维离散化。

正交解调的原理图如下：
![](../Image/2.7.png)

经过正交解调后的信号就是SAR的原始回波数据，对于前述的线性调频信号，解调之后可以得到：
$$
s_r(\tau,\eta)=A_0 \omega_r(\tau - \frac{2R(\eta)}{c}) \omega_a(\eta - \eta_c) 
\\ \times exp\{j \pi K_r (\tau - \frac{2R(\eta)}{c})\}exp\{- j \frac{4 \pi f_0 R(\eta)}{c} \}
$$

随后进行距离维的采样便可以得到一组离散的二维信号。

###2.2 脉冲压缩

对距离维得到的脉冲进行频域的滤波能够实现脉冲压缩。脉冲压缩能够提高信号的分辨率。

对2.1得到的SAR原始回波进行匹配滤波，得到压缩后的信号为：
$$
s_{r,c}(\tau,\eta)=A_0 p_r (\tau - \frac{2R(\eta)}{c} ) \omega_a(\eta - \eta_c)exp\{- j \frac{4 \pi f_0 R(\eta)}{c} \}
$$
其中，$p_r (\tau - \frac{2R(\eta)}{c} )$为压缩后的窄脉冲。脉冲压缩后的分辨率和$LFM$信号的带宽有关，其公式为：
$$
\rho=\frac{c}{2B}
$$

###2.3 成像算法

在完成上述的信号处理后，可以使用RD算法对信号进行成像，得到仿真的SAR图像。

$RD$算法的实现流程为：
![](../Image/2.8.png)

